# Dependency Graph - Output Formats

> 이 파일은 `/deps` 스킬의 출력 형식 상세 정의입니다.

---

## 기본 출력: 도메인 의존성 (`/deps`)

```
===========================================================
  Dependency Graph: <대상>
===========================================================

  Scope: <전체 프로젝트|도메인명|디렉토리 경로>
  Domains Found: <N>개
  Total Cross-Domain Dependencies: <N>개
  Circular Dependencies: <있음/없음>

-----------------------------------------------------------
  Mermaid Diagram
-----------------------------------------------------------

  ```mermaid
  graph LR
    order["Order<br/>(Ca:2, Ce:3, I:0.60)"]
    member["Member<br/>(Ca:3, Ce:1, I:0.25)"]
    product["Product<br/>(Ca:2, Ce:0, I:0.00)"]
    payment["Payment<br/>(Ca:0, Ce:2, I:1.00)"]

    order -->|"API 2"| member
    order -->|"API 2"| product
    order -->|"import 1"| payment
    payment -->|"API 1"| order

    style product fill:#4CAF50,color:#fff
    style payment fill:#FF9800,color:#fff
  ```

-----------------------------------------------------------
  Domain Summary
-----------------------------------------------------------

  | Domain   | Ca | Ce | I    | Grade    |
  |----------|----|----|------|----------|
  | member   | 3  | 1  | 0.25 | Loose    |
  | product  | 2  | 0  | 0.00 | Loose    |
  | order    | 2  | 3  | 0.60 | Moderate |
  | payment  | 0  | 2  | 1.00 | Loose    |

===========================================================
```

---

## 특정 도메인 의존성 (`/deps show <도메인>`)

```
===========================================================
  Dependency Graph: <도메인명> Domain
===========================================================

-----------------------------------------------------------
  [의존하는 것] (이 도메인이 사용하는 외부 의존성)
-----------------------------------------------------------
  +-- <도메인A> (API <N>개)
  |   +-- <METHOD> /<경로> - <설명>
  +-- <도메인B> (import <N>개)
      +-- <모듈경로> - <클래스/함수명>

-----------------------------------------------------------
  [의존받는 것] (이 도메인을 사용하는 외부 의존성)
-----------------------------------------------------------
  +-- <도메인C> (API <N>개)
      +-- <METHOD> /<경로> - <설명>

-----------------------------------------------------------
  [순환 의존성]
-----------------------------------------------------------
  +-- 없음

===========================================================
```

---

## 순환 의존성 전용 (`/deps --cycles`)

```
===========================================================
  Circular Dependency Report
===========================================================

  Total Cycles Found: <N>

-----------------------------------------------------------
  [CRITICAL] Domain-Level Cycles
-----------------------------------------------------------

  Cycle 1:
    order -> payment -> order
    |
    +-- order/services/checkout.py:L15
    |     from payment.services.payment_service import process
    +-- payment/services/refund.py:L8
          from order.services.order_service import get_order

-----------------------------------------------------------
  Recommendations
-----------------------------------------------------------

  1. [CRITICAL] order <-> payment:
     - payment에서 order 참조 제거 권장
     - 이벤트 기반 비동기 통신으로 전환 검토
     - 참조: Dependency Inversion Principle (DIP)

===========================================================
```

---

## 파일 의존성 트리 (`/deps <파일> --tree`)

```
===========================================================
  Dependency Tree: <파일경로>
===========================================================

  [이 파일이 의존하는 것] (Outgoing)
  <파일명>
  +-- <import 1> (<도메인>)
  |   +-- <import 1-1> (<도메인>)
  +-- <import 2> (<도메인>)

  [이 파일에 의존하는 것] (Incoming)
  <파일명>
  +-- <dependent 1> (<도메인>)

  Tree Depth: <N> levels
  Total Unique Dependencies: <N> files
  Cross-Domain References: <N>

===========================================================
```

---

## 도메인 간 의존성 매트릭스 (`/deps --matrix`)

```
===========================================================
  Cross-Domain Dependency Matrix
===========================================================

  (행: 의존하는 쪽 -> 열: 의존받는 쪽)

  |          | order | member | product | payment | auth |
  |----------|-------|--------|---------|---------|------|
  | order    |   -   |   2    |    2    |    1    |  1   |
  | member   |   0   |   -    |    0    |    0    |  1   |
  | product  |   0   |   0    |    -    |    0    |  0   |
  | payment  |   1   |   0    |    0    |    -    |  1   |
  | auth     |   0   |   1    |    0    |    0    |  -   |

  Legend:
    숫자 = 교차 의존성 수 (import + API 호출)
    0    = 의존 관계 없음
    -    = 자기 자신 (내부 의존성)

-----------------------------------------------------------
  Hotspots (높은 결합도)
-----------------------------------------------------------
  1. order -> member (2): API 호출 2건
  2. order -> product (2): API 호출 2건

===========================================================
```

---

## 결합도 등급

| 등급 | 교차 의존 수 | 평가 |
|------|-------------|------|
| Loose (느슨) | 0-2개 | 건전한 상태 |
| Moderate (보통) | 3-5개 | 관리 가능 |
| Tight (밀접) | 6-10개 | 리팩토링 검토 권장 |
| Tangled (얽힘) | 11개 이상 | 리팩토링 필수 |

---

## 불안정성 지표 (Instability)

```
I = Ce / (Ca + Ce)

I = 0.0: 완전히 안정 (다른 도메인이 많이 의존, 변경 시 영향 큼)
I = 1.0: 완전히 불안정 (다른 도메인에 많이 의존, 변경이 용이)
I = 0.5: 중간 (균형 잡힌 상태)
```
